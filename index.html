<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>WALLET</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="css/mdb.min.css" rel="stylesheet">
    <!-- Your custom styles (optional) -->
    <link href="css/style.css" rel="stylesheet">
</head>

<body>

    <!--Navbar-->
<nav class="navbar navbar-expand-lg navbar-dark color">

    <div class="container">
   
     <!-- Collapse button -->
     <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav" aria-controls="basicExampleNav"
     aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
     </button>
   
     <!-- Collapsible content -->
     <div class="collapse navbar-collapse justify-content-center font-weight-bold" id="basicExampleNav">
       
        <a class="navbar-brand px-lg-4 mr-0" href="#">
            <img src="img/logo/chainflux.png" height="30" alt="">
        </a>
       <!-- Links -->
       <ul class=" navbar-nav">
        <li class="nav-item ">
         <a class="nav-link" href="#home" onclick="home()">Home</a>
        </li>
        <li class="nav-item ">
         <a class="nav-link" href="#form" onclick="sign()">Create Account</a>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="#wallet" onclick="wallet()">Use Wallet</a>
        </li>
   
       </ul>
    </div>
    </div>
</nav>
<div class="tab-content"> 
<div id="home" class="tab-pane fade in active">

</div>
<div id="form">
    <!--Section: Live preview-->
<section class="form-dark">

    <!--Form without header-->
    <div class="card card-image" style="background-image: url('https://mdbootstrap.com/img/Photos/Others/pricing-table7.jpg'); width: 28rem;">
        <div class="text-white rgba-stylish-strong py-5 px-5 z-depth-4">

            <!--Header-->
            <div class="text-center">
                <h3 class="white-text mb-5 mt-4 font-weight-bold"><strong>CREATE</strong> <a class="green-text font-weight-bold"><strong>ACCOUNT</strong></a></h3>
            </div>

            <!--Body-->
            <div class="md-form">
                <input type="password" id="value1" class="form-control white-text">
                <label for="password">Password</label>
            </div>

            <div class="md-form pb-3">
                <input type="password" id="value2" class="form-control white-text">
                <label for="Re-type password">Re-type password</label>
            </div>

            <!--Grid row-->
            <div class="row d-flex align-items-center mb-4">

                <!--Grid column-->
                <div class="text-center mb-3 col-md-12">
                    <button type="button" class="btn btn-success btn-block btn-rounded z-depth-1" onclick="create_account()">Create</button>
                </div>
                <!--Grid column-->
            </div>
            <!--Grid row-->

            <!--Grid column-->
            <div class="col-md-12">
                 <a href="#login" id="account"  data-toggle="modal" data-target="#modalLoginForm" ></a>
            </div>
            <!--Grid column-->

        </div>
    </div>
    <!--/Form without header-->

</section>
<!--Section: Live preview-->
</div>
    <div class="modal fade" id="modalLoginForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header text-center">
                    <h4 class="modal-title w-100 font-weight-bold">Sign in</h4>
                         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                         <span aria-hidden="true">&times;</span>
                         </button>
                </div>
                <div class="modal-body mx-3">
                    <div class="md-form mb-5">
                        <input type="text" id="address" class="form-control validate" hidden>
                    </div>
            
                    <div class="md-form mb-4">
                        <i class="fa fa-lock prefix grey-text"></i>
                        <input type="password" id="pass" class="form-control validate">
                        <label data-error="wrong" data-success="right" for="defaultForm-pass">Your password</label>
                    </div>
            
                </div>
                <div class="modal-footer d-flex justify-content-center">
                    <button class="btn btn-default" data-dismiss="modal" onclick="unlock1()">Login</button>
            </div>
            </div>
        </div>
    </div>
<div id="list" >
        <section class="form-dark">

        <!--Form without header-->
        <div class="card card-image" style="background-image: url('https://mdbootstrap.com/img/Photos/Others/pricing-table7.jpg'); width: 28rem;">
            <div class="text-white rgba-stylish-strong py-5 px-5 z-depth-4">
    
                <!--Header-->
                <div class="text-center">
                    <h3 class="white-text mb-5 mt-4 font-weight-bold"><strong>LIST</strong> <a class="green-text font-weight-bold"><strong>OF ACCOUNT</strong></a></h3>
                </div>
                <!--Grid row-->
                <div class="row d-flex align-items-center mb-4">
    
                    <!--Grid column-->
                    <div class="text-center mb-3 col-md-12">
                        <button type="button" class="btn btn-success btn-block btn-rounded z-depth-1" onclick="accounts();">VIEW LIST OF ACCOUNTS</button>
                    </div>
                    <!--Grid column-->
                </div>
    
            </div>
        </div>
        <!--/Form without header-->
    
    </section>

</div>
<div id="list_account">
  <div class="container">
      <center>
            <div class="col-sm-2"></div>
            <div class="col-sm-6 scrollable">
                    <table class="table table-striped "><thead><tr><th>ACCOUNT LIST</th></thead><tbody id="body_bank" class="scrollme"></tbody></table> 
            </div>
            <div class="col-sm-2"></div>
      </center>

  </div>
     
</div>
<div class="modal fade" id="modalForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header text-center">
                    <h4 class="modal-title w-100 font-weight-bold">Sign in</h4>
                         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                         <span aria-hidden="true">&times;</span>
                         </button>
                </div>
                <div class="modal-body mx-3">
                    <div class="md-form mb-5">
                        <input type="text" id="address1" class="form-control validate" hidden>
                    </div>
            
                    <div class="md-form mb-4">
                        <i class="fa fa-lock prefix grey-text"></i>
                        <input type="password" id="pass1" class="form-control validate">
                        <label  for="defaultForm-pass">Your password</label>
                    </div>
            
                </div>
                <div class="modal-footer d-flex justify-content-center">
                    <button class="btn btn-default" data-dismiss="modal" onclick="unlock_account()">Login</button>
            </div>
            </div>
        </div>
    </div>
<div id="view">
    <!--Jumbotron-->
    <div class="container">
        <div class="jumbotron jumbotron-fluid">
            <h4><b>Your Account Address:</b></h4><h6><p id="vaddress"></p></h6>
            <h4><b>Your Balance:</b></h4><h6><p id="vbalance"></p></h6>
            <center><button type="button" class="btn btn-success  btn-rounded z-depth-1" onclick="back();"><B>BACK</B></button></center>
        </div>
    
    </div>
 </div>
<div id="accounts">
    <section class="form-dark">

        <!--Form without header-->
        <div class="card card-image" style="background-image: url('https://mdbootstrap.com/img/Photos/Others/pricing-table7.jpg'); width: 28rem;">
            <div class="text-white rgba-stylish-strong py-5 px-5 z-depth-4">
    
                <!--Header-->
                <div class="text-center">
                    <h3 class="white-text mb-5 mt-4 font-weight-bold"><strong>ACCOUNT</strong> <a class="green-text font-weight-bold"><strong>DETAILS</strong></a></h3>
                </div>
                <!--Grid row-->
                <div class="row d-flex align-items-center mb-4">
    
                    <!--Grid column-->
                    <div class="text-center mb-3 col-md-12">
                        <h4>Address</h4><p id="a"></p>
                        <button type="button" class="btn btn-success btn-block btn-rounded z-depth-1" onclick="View();">VIEW ACCOUNT DETAILS</button>
                        <button type="button" class="btn btn-success btn-block btn-rounded z-depth-1" onclick="page();">SEND TRANSACTION</button>
                    </div>
                    <!--Grid column-->
                </div>
    
            </div>
        </div>
        <!--/Form without header-->
    
    </section> 
</div>
<div id="send" class="container">
    <section class="form-dark">

                <!--Form without header-->
                <div class="card card-image" style="background-image: url('https://mdbootstrap.com/img/Photos/Others/pricing-table7.jpg'); width: 28rem;">
                    <div class="text-white rgba-stylish-strong py-5 px-5 z-depth-4">
            
                        <!--Header-->
                        <div class="text-center">
                            <h3 class="white-text mb-5 mt-4 font-weight-bold"><strong>ACCOUNT</strong> <a class="green-text font-weight-bold"><strong>DETAILS</strong></a></h3>
                        </div>
                        <!--Grid row-->
                        <div class="row d-flex align-items-center mb-4">
            
                            <!--Grid column-->
                            <div class="text-center mb-3 col-md-12">
                                <h4>Address</h4><p id="b"></p>
                               
                                <div class="md-form mb-4">
                                       <label for="To Address">To Address</label>
                                        <select id="la" class="container">
                                               
                                        </select>
                                        <!-- <input type="text" id="to" class="form-control validate">
                                        <label data-error="wrong" data-success="right" for="defaultForm-pass">To Address</label> -->
                                </div>
                                <div class="md-form mb-4">
                                        <input type="text" id="aion" class="form-control validate">
                                        <label data-error="wrong" data-success="right" for="defaultForm-pass">Amount</label>
                                </div>
                                <button type="button" class="btn btn-success btn-rounded z-depth-1" onclick="back();">BACK</button>
                                <button type="button" class="btn btn-success btn-rounded z-depth-1" onclick="transaction();">SEND</button>
                            </div>
                            <!--Grid column-->
                        </div>
            
                    </div>
                </div>
                <!--/Form without header-->
            
    </section> 

</div>

</div>
   <!-- SCRIPTS -->
    <!-- JQuery -->
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="js/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="js/mdb.min.js"></script>
    <script type="text/javascript" src="js/app/web3.min.js"></script>
    <!-- <script type="text/javascript" src="js/app/app.js"></script> -->
    <script>
        var web3= new Web3(new Web3.providers.HttpProvider('http://18.191.165.67:8545'));
        var arr=[];
       
         $('#form').hide();
         $('#list').hide();
         $('#list_account').hide();
         $('#accounts').hide();
         $('#view').hide();
         $('#send').hide();
         
        function home(){
             $('#home').show();
             $('#form').hide();
             $('#list').hide();
             $('#list_account').hide();
             $('#view').hide();
             $('#accounts').hide();
             $('#send').hide();
        }
        function sign(){
            $('#home').hide();
            $('#form').show();
            $('#list').hide();
            $('#list_account').hide();
            $('#view').hide();
            $('#send').hide();
            $('#accounts').hide();
        }
        function entry(){
            $('#form').hide();
            $('#login').show();
            $('#list').hide();
            $('#list_account').hide();
            $('#view').hide();
            $('#send').hide();
            $('#accounts').hide();
        }
        function wallet(){
            $('#list').show();
            $('#form').hide();
            $('#login').hide();
            $('#home').hide();
            $('#list_account').hide();
            $('#view').hide();
            $('#send').hide();
            $('#accounts').hide();
        }
        function View(){
            $('#accounts').hide();
            $('#view').show();
            $('#send').hide();
        }
        function back(){
            $('#accounts').show();
            $('#view').hide();
            $('#send').hide();
        }
        function page(){
            var a =web3.personal.listAccounts;
            $('#accounts').hide();
            $('#send').show();
            $('#la').html('');
            for(var i=0; i<a.length; i++){
         
                $("#la").append('<option value="'+a[i]+'" id="to" >'+a[i]+'</option>');
            }   
        }
        function create_account(){
            var password1=document.getElementById('value1').value;
            var password2=document.getElementById('value2').value;
            if(password1=="" && password2 == ""){
                alert("Enter the password");
                document.getElementById('value1').value="";
                document.getElementById('value2').value="";
            }
            else if(password1 != "" && password2 != ""){
                if(password1==password2){
                var b=web3.personal.newAccount(password1);
                document.getElementById('account').innerHTML=b;
                document.getElementById('address').value=b;
                alert("Account Created");
               document.getElementById('value1').value="";
               document.getElementById('value2').value="";
            }
            else{
                alert("password mismatch");
                document.getElementById('value1').value="";
                document.getElementById('value2').value="";
            }
           }
        }   
        function unlock1(){
            
            var account=document.getElementById('address').value;
            var password = document.getElementById('pass').value;
            var unlock=web3.personal.unlockAccount(account,password);
            if(unlock== true){
                $('#accounts').show();
                $('#view').hide();
                $('#form').hide();
                $('#login').hide();
                alert("your logged in");
                var b =web3.eth.getBalance(account).shiftedBy(-18).toString();
                document.getElementById('vaddress').innerHTML= account;
                document.getElementById('b').innerHTML= account;
                document.getElementById('b').value= account;
                document.getElementById('address').value="";
                document.getElementById('pass').value="";
             }
            else{
                alert("Password wrong");
                document.getElementById('address').value="";
                document.getElementById('pass').value="";
            }
        }   
        function account(a1){
            var a =web3.personal.listAccounts;
            for(var i=0;i<a.length;i++){
                 arr.push(a[i]);
            }
             document.getElementById('address1').value=arr[a1];
        }
        function accounts(){
            var a =web3.personal.listAccounts;
            $('#list_account').show();
            $('#list').hide();
            $('#accounts').hide();
            $('#send').hide();
           $('#body_bank').html(''); 
          for(var i=0; i<a.length; i++){
         
            $("#body_bank").append('<tr><td><a href=# data-toggle="modal" data-target="#modalForm" onclick="account('+i+')">'+a[i]+'</a></td></tr>');
          }                        
    }   
    function unlock_account(){
    var address=document.getElementById('address1').value;
    var password=document.getElementById('pass1').value;
    var unlock=web3.personal.unlockAccount(address,password);
    if(unlock== true){
        $('#accounts').show();
        $('#unlock').hide();
        $('#list_account').hide();
        $('#view').hide();
        alert("your logged in");
        var balance=document.getElementById('address1').value;
        var b =web3.eth.getBalance(balance).toString();
        document.getElementById('a').innerHTML= address;
        document.getElementById('b').innerHTML= address;
        document.getElementById('b').value= address;
        document.getElementById('vaddress').innerHTML= address;
        document.getElementById('vbalance').innerHTML= b;
        document.getElementById('address1').value="";
        document.getElementById('pass1').value="";
    }
    else{
        alert("Password wrong");
        document.getElementById('address1').value="";
        document.getElementById('pass1').value="";
    }
   } 
   function transaction(){
        $('#accounts').hide();
        var fromaddress=document.getElementById('b').value;
        var toaddress =document.getElementById('to').value;
        var amount = document.getElementById('aion').value;
        console.log(fromaddress);
        console.log(toaddress);
        
        web3.eth.sendTransaction({from:fromaddress,to:toaddress,value:amount},function(err,res){
            if(err){
                console.log(err);
            }
            else{
                alert("Transaction Successfully")
            }
        })
   }
    </script>
</body>

</html>
